<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-5451440010209476"
     crossorigin="anonymous"></script>
    <meta name="viewport" content="user-scalable=no, width=device-width">
    <title>静态广告接口测试工具</title>
    <script>
        var _countryList = {DEU:{nameEn:'Germany',nameCh:'德国'},USA:{nameEn:'United States',nameCh:'美国'},GBR:{nameEn:'United Kingdom',nameCh:'英国'},AUS:{nameEn:'Australia',nameCh:'澳大利亚'},AFG:{nameEn:'Afghanistan',nameCh:'阿富汗'},ALA:{nameEn:'Åland Islands',nameCh:'奥兰'},ALB:{nameEn:'Albania',nameCh:'阿尔巴尼亚'},DZA:{nameEn:'Algeria',nameCh:'阿尔及利亚'},ASM:{nameEn:'American Samoa',nameCh:'美属萨摩亚'},AND:{nameEn:'Andorra',nameCh:'安道尔'},AGO:{nameEn:'Angola',nameCh:'安哥拉'},AIA:{nameEn:'Anguilla',nameCh:'安圭拉'},ATG:{nameEn:'Antigua & Barbuda',nameCh:'安巴'},ARG:{nameEn:'Argentina',nameCh:'阿根廷'},ARM:{nameEn:'Armenia',nameCh:'亚美尼亚'},ABW:{nameEn:'Aruba',nameCh:'阿鲁巴'},AUT:{nameEn:'Austria',nameCh:'奥地利'},AZE:{nameEn:'Azerbaijan',nameCh:'阿塞拜疆'},BHS:{nameEn:'Bahamas',nameCh:'巴哈马'},BHR:{nameEn:'Bahrain',nameCh:'巴林'},BGD:{nameEn:'Bangladesh',nameCh:'孟加拉'},BRB:{nameEn:'Barbados',nameCh:'巴巴多斯'},BLR:{nameEn:'Belarus',nameCh:'白俄罗斯'},BEL:{nameEn:'Belgium',nameCh:'比利时'},BLZ:{nameEn:'Belize',nameCh:'伯利兹'},BEN:{nameEn:'Benin',nameCh:'贝宁'},BMU:{nameEn:'Bermuda',nameCh:'百慕大'},BTN:{nameEn:'Bhutan',nameCh:'不丹'},BOL:{nameEn:'Bolivia',nameCh:'玻利维亚'},BES:{nameEn:'Caribbean Netherlands',nameCh:'荷兰加勒比区'},BIH:{nameEn:'Bosnia & Herzegovina',nameCh:'波黑'},BWA:{nameEn:'Botswana',nameCh:'博茨瓦纳'},BVT:{nameEn:'Bouvet Island',nameCh:'布韦岛'},BRA:{nameEn:'Brazil',nameCh:'巴西'},IOT:{nameEn:'British Indian Ocean Territory',nameCh:'英属印度洋领地'},BRN:{nameEn:'Brunei',nameCh:'文莱'},BGR:{nameEn:'Bulgaria',nameCh:'保加利亚'},BFA:{nameEn:'Burkina Faso',nameCh:'布基纳法索'},BDI:{nameEn:'Burundi',nameCh:'布隆迪'},CPV:{nameEn:'Cape Verde',nameCh:'佛得角'},KHM:{nameEn:'Cambodia',nameCh:'柬埔寨'},CMR:{nameEn:'Cameroon',nameCh:'喀麦隆'},CAN:{nameEn:'Canada',nameCh:'加拿大'},CYM:{nameEn:'Cayman Islands',nameCh:'开曼群岛'},CAF:{nameEn:'Central African Republic',nameCh:'中非'},TCD:{nameEn:'Chad',nameCh:'乍得'},CHL:{nameEn:'Chile',nameCh:'智利'},CHN:{nameEn:'China',nameCh:'中国'},CXR:{nameEn:'Christmas Island',nameCh:'圣诞岛'},CCK:{nameEn:'Cocos (Keeling) Islands',nameCh:'科科斯(基林)群岛'},COL:{nameEn:'Colombia',nameCh:'哥伦比亚'},COM:{nameEn:'Comoros',nameCh:'科摩罗'},COG:{nameEn:'Congo - Brazzaville',nameCh:'刚果(布)'},COD:{nameEn:'Congo - Kinshasa',nameCh:'刚果(金)'},COK:{nameEn:'Cook Islands',nameCh:'库克群岛'},CRI:{nameEn:'Costa Rica',nameCh:'哥斯达黎加'},CIV:{nameEn:"Côte d'Ivoire",nameCh:'科特迪瓦'},HRV:{nameEn:'Croatia',nameCh:'克罗地亚'},CUB:{nameEn:'Cuba',nameCh:'古巴'},CUW:{nameEn:'Curaçao',nameCh:'库拉索'},CYP:{nameEn:'Cyprus',nameCh:'塞浦路斯'},CZE:{nameEn:'Czechia',nameCh:'捷克'},DNK:{nameEn:'Denmark',nameCh:'丹麦'},DJI:{nameEn:'Djibouti',nameCh:'吉布提'},DMA:{nameEn:'Dominica',nameCh:'多米尼克'},DOM:{nameEn:'Dominican Republic',nameCh:'多米尼加'},DXB:{nameEn:'Dubai',nameCh:'迪拜'},ECU:{nameEn:'Ecuador',nameCh:'厄瓜多尔'},EGY:{nameEn:'Egypt',nameCh:'埃及'},SLV:{nameEn:'El Salvador',nameCh:'萨尔瓦多'},GNQ:{nameEn:'Equatorial Guinea',nameCh:'赤道几内亚'},ERI:{nameEn:'Eritrea',nameCh:'厄立特里亚'},EST:{nameEn:'Estonia',nameCh:'爱沙尼亚'},SWZ:{nameEn:'Eswatini',nameCh:'斯威士兰'},ETH:{nameEn:'Ethiopia',nameCh:'埃塞俄比亚'},FLK:{nameEn:'Falkland Islands (Islas Malvinas)',nameCh:'福克兰群岛'},FRO:{nameEn:'Faroe Islands',nameCh:'法罗群岛'},FJI:{nameEn:'Fiji',nameCh:'斐济'},FIN:{nameEn:'Finland',nameCh:'芬兰'},FRA:{nameEn:'France',nameCh:'法国'},GUF:{nameEn:'French Guiana',nameCh:'法属圭亚那'},PYF:{nameEn:'French Polynesia',nameCh:'法属波利尼西亚'},ATF:{nameEn:'French Southern Territories',nameCh:'法属南方和南极洲领地'},GAB:{nameEn:'Gabon',nameCh:'加蓬'},GMB:{nameEn:'Gambia',nameCh:'冈比亚'},GEO:{nameEn:'Georgia',nameCh:'格鲁吉亚'},GHA:{nameEn:'Ghana',nameCh:'加纳'},GIB:{nameEn:'Gibraltar',nameCh:'直布罗陀'},GRC:{nameEn:'Greece',nameCh:'希腊'},GRL:{nameEn:'Greenland',nameCh:'格陵兰'},GRD:{nameEn:'Grenada',nameCh:'格林纳达'},GLP:{nameEn:'Guadeloupe',nameCh:'瓜德罗普'},GUM:{nameEn:'Guam',nameCh:'关岛'},GTM:{nameEn:'Guatemala',nameCh:'危地马拉'},GGY:{nameEn:'Guernsey',nameCh:'根西'},GIN:{nameEn:'Guinea',nameCh:'几内亚'},GNB:{nameEn:'Guinea-Bissau',nameCh:'几内亚比绍'},GUY:{nameEn:'Guyana',nameCh:'圭亚那'},HTI:{nameEn:'Haiti',nameCh:'海地'},HMD:{nameEn:'Heard Island and McDonald Islands',nameCh:'赫德岛和麦克唐纳群岛'},VAT:{nameEn:'Vatican City',nameCh:'梵蒂冈'},HND:{nameEn:'Honduras',nameCh:'洪都拉斯'},HKG:{nameEn:'Hong Kong',nameCh:'香港'},HUN:{nameEn:'Hungary',nameCh:'匈牙利'},ISL:{nameEn:'Iceland',nameCh:'冰岛'},IND:{nameEn:'India',nameCh:'印度'},IDN:{nameEn:'Indonesia',nameCh:'印度尼西亚'},IRN:{nameEn:'Iran',nameCh:'伊朗'},IRQ:{nameEn:'Iraq',nameCh:'伊拉克'},IRL:{nameEn:'Ireland',nameCh:'爱尔兰'},IMN:{nameEn:'Isle of Man',nameCh:'马恩岛'},ISR:{nameEn:'Israel',nameCh:'以色列'},ITA:{nameEn:'Italy',nameCh:'意大利'},JAM:{nameEn:'Jamaica',nameCh:'牙买加'},JPN:{nameEn:'Japan',nameCh:'日本'},JEY:{nameEn:'Jersey',nameCh:'泽西'},JOR:{nameEn:'Jordan',nameCh:'约旦'},KAZ:{nameEn:'Kazakhstan',nameCh:'哈萨克斯坦'},KEN:{nameEn:'Kenya',nameCh:'肯尼亚'},KIR:{nameEn:'Kiribati',nameCh:'基里巴斯'},PRK:{nameEn:'North Korea',nameCh:'朝鲜'},KOR:{nameEn:'South Korea',nameCh:'韩国'},KWT:{nameEn:'Kuwait',nameCh:'科威特'},KGZ:{nameEn:'Kyrgyzstan',nameCh:'吉尔吉斯斯坦'},LAO:{nameEn:'Laos',nameCh:'老挝'},LVA:{nameEn:'Latvia',nameCh:'拉脱维亚'},LBN:{nameEn:'Lebanon',nameCh:'黎巴嫩'},LSO:{nameEn:'Lesotho',nameCh:'莱索托'},LBR:{nameEn:'Liberia',nameCh:'利比里亚'},LBY:{nameEn:'Libya',nameCh:'利比亚'},LIE:{nameEn:'Liechtenstein',nameCh:'列支敦士登'},LTU:{nameEn:'Lithuania',nameCh:'立陶宛'},LUX:{nameEn:'Luxembourg',nameCh:'卢森堡'},MAC:{nameEn:'Macau',nameCh:'澳门'},MKD:{nameEn:'North Macedonia',nameCh:'北马其顿'},MDG:{nameEn:'Madagascar',nameCh:'马达加斯加'},MWI:{nameEn:'Malawi',nameCh:'马拉维'},MYS:{nameEn:'Malaysia',nameCh:'马来西亚'},MDV:{nameEn:'Maldives',nameCh:'马尔代夫'},MLI:{nameEn:'Mali',nameCh:'马里'},MLT:{nameEn:'Malta',nameCh:'马耳他'},MHL:{nameEn:'Marshall Islands',nameCh:'马绍尔群岛'},MTQ:{nameEn:'Martinique',nameCh:'马提尼克'},MRT:{nameEn:'Mauritania',nameCh:'毛里塔尼亚'},MUS:{nameEn:'Mauritius',nameCh:'毛里求斯'},MYT:{nameEn:'Mayotte',nameCh:'马约特'},MEX:{nameEn:'Mexico',nameCh:'墨西哥'},FSM:{nameEn:'Micronesia',nameCh:'密克罗尼西亚联邦'},MDA:{nameEn:'Moldova',nameCh:'摩尔多瓦'},MCO:{nameEn:'Monaco',nameCh:'摩纳哥'},MNG:{nameEn:'Mongolia',nameCh:'蒙古国'},MNE:{nameEn:'Montenegro',nameCh:'黑山'},MSR:{nameEn:'Montserrat',nameCh:'蒙特塞拉特'},MAR:{nameEn:'Morocco',nameCh:'摩洛哥'},MOZ:{nameEn:'Mozambique',nameCh:'莫桑比克'},MMR:{nameEn:'Myanmar (Burma)',nameCh:'缅甸'},NAM:{nameEn:'Namibia',nameCh:'纳米比亚'},NRU:{nameEn:'Nauru',nameCh:'瑙鲁'},NPL:{nameEn:'Nepal',nameCh:'尼泊尔'},NLD:{nameEn:'Netherlands',nameCh:'荷兰'},NCL:{nameEn:'New Caledonia',nameCh:'新喀里多尼亚'},NZL:{nameEn:'New Zealand',nameCh:'新西兰'},NIC:{nameEn:'Nicaragua',nameCh:'尼加拉瓜'},NER:{nameEn:'Niger',nameCh:'尼日尔'},NGA:{nameEn:'Nigeria',nameCh:'尼日利亚'},NIU:{nameEn:'Niue',nameCh:'纽埃'},NFK:{nameEn:'Norfolk Island',nameCh:'诺福克岛'},MNP:{nameEn:'Northern Mariana Islands',nameCh:'北马里亚纳群岛'},NOR:{nameEn:'Norway',nameCh:'挪威'},OMN:{nameEn:'Oman',nameCh:'阿曼'},PAK:{nameEn:'Pakistan',nameCh:'巴基斯坦'},PLW:{nameEn:'Palau',nameCh:'帕劳'},PSE:{nameEn:'Palestine, State of',nameCh:'巴勒斯坦'},PAN:{nameEn:'Panama',nameCh:'巴拿马'},PRY:{nameEn:'Paraguay',nameCh:'巴拉圭'},PER:{nameEn:'Peru',nameCh:'秘鲁'},PHL:{nameEn:'Philippines',nameCh:'菲律宾'},PCN:{nameEn:'Pitcairn',nameCh:'皮特凯恩群岛'},POL:{nameEn:'Poland',nameCh:'波兰'},PRT:{nameEn:'Portugal',nameCh:'葡萄牙'},PRI:{nameEn:'Puerto Rico',nameCh:'波多黎各'},QAT:{nameEn:'Qatar',nameCh:'卡塔尔'},REU:{nameEn:'Réunion',nameCh:'留尼汪'},ROU:{nameEn:'Romania',nameCh:'罗马尼亚'},RUS:{nameEn:'Russian Federation',nameCh:'俄罗斯'},RWA:{nameEn:'Rwanda',nameCh:'卢旺达'},BLM:{nameEn:'St. Barthélemy',nameCh:'圣巴泰勒米'},SHN:{nameEn:'St. Helena',nameCh:'圣赫勒拿阿森松和特里斯坦达库尼亚'},KNA:{nameEn:'St. Kitts & Nevis',nameCh:'圣基茨和尼维斯'},LCA:{nameEn:'St. Lucia',nameCh:'圣卢西亚'},MAF:{nameEn:'St. Martin',nameCh:'法属圣马丁'},SPM:{nameEn:'St. Pierre & Miquelon',nameCh:'圣皮埃尔和密克隆'},VCT:{nameEn:'St. Vincent & Grenadines',nameCh:'圣文森特和格林纳丁斯'},WSM:{nameEn:'Samoa',nameCh:'萨摩亚'},SMR:{nameEn:'San Marino',nameCh:'圣马力诺'},STP:{nameEn:'Sao Tome & Principe',nameCh:'圣普'},SAU:{nameEn:'Saudi Arabia',nameCh:'沙特阿拉伯'},SEN:{nameEn:'Senegal',nameCh:'塞内加尔'},SRB:{nameEn:'Serbia',nameCh:'塞尔维亚'},SYC:{nameEn:'Seychelles',nameCh:'塞舌尔'},SLE:{nameEn:'Sierra Leone',nameCh:'塞拉利昂'},SGP:{nameEn:'Singapore',nameCh:'新加坡'},SXM:{nameEn:'Sint Maarten',nameCh:'圣马丁'},SVK:{nameEn:'Slovakia',nameCh:'斯洛伐克'},SVN:{nameEn:'Slovenia',nameCh:'斯洛文尼亚'},SLB:{nameEn:'Solomon Islands',nameCh:'所罗门群岛'},SOM:{nameEn:'Somalia',nameCh:'索马里'},ZAF:{nameEn:'South Africa',nameCh:'南非'},SGS:{nameEn:'South Georgia and the South Sandwich Islands',nameCh:'南乔治亚和南桑威奇群岛'},SSD:{nameEn:'South Sudan',nameCh:'南苏丹'},ESP:{nameEn:'Spain',nameCh:'西班牙'},LKA:{nameEn:'Sri Lanka',nameCh:'斯里兰卡'},SDN:{nameEn:'Sudan',nameCh:'苏丹'},SUR:{nameEn:'Suriname',nameCh:'苏里南'},SJM:{nameEn:'Svalbard and Jan Mayen',nameCh:'斯瓦尔巴和扬马延'},SWE:{nameEn:'Sweden',nameCh:'瑞典'},CHE:{nameEn:'Switzerland',nameCh:'瑞士'},SYR:{nameEn:'Syria',nameCh:'叙利亚'},TWN:{nameEn:'Taiwan',nameCh:'台湾'},TJK:{nameEn:'Tajikistan',nameCh:'塔吉克斯坦'},TZA:{nameEn:'Tanzania',nameCh:'坦桑尼亚'},THA:{nameEn:'Thailand',nameCh:'泰国'},TLS:{nameEn:'Timor-Leste',nameCh:'东帝汶'},TGO:{nameEn:'Togo',nameCh:'多哥'},TKL:{nameEn:'Tokelau',nameCh:'托克劳'},TON:{nameEn:'Tonga',nameCh:'汤加'},TTO:{nameEn:'Trinidad & Tobago',nameCh:'特多'},TUN:{nameEn:'Tunisia',nameCh:'突尼斯'},TUR:{nameEn:'Turkey',nameCh:'土耳其'},TKM:{nameEn:'Turkmenistan',nameCh:'土库曼斯坦'},TCA:{nameEn:'Turks & Caicos Islands',nameCh:'特克斯和凯科斯群岛'},TUV:{nameEn:'Tuvalu',nameCh:'图瓦卢'},UGA:{nameEn:'Uganda',nameCh:'乌干达'},UKR:{nameEn:'Ukraine',nameCh:'乌克兰'},ARE:{nameEn:'United Arab Emirates',nameCh:'阿联酋'},UMI:{nameEn:'United States Minor Outlying Islands',nameCh:'美国本土外小岛屿'},URY:{nameEn:'Uruguay',nameCh:'乌拉圭'},UZB:{nameEn:'Uzbekistan',nameCh:'乌兹别克斯坦'},VUT:{nameEn:'Vanuatu',nameCh:'瓦努阿图'},VEN:{nameEn:'Venezuela',nameCh:'委内瑞拉'},VNM:{nameEn:'Vietnam',nameCh:'越南'},VGB:{nameEn:'British Virgin Islands',nameCh:'英属维尔京群岛'},VIR:{nameEn:'U.S. Virgin Islands',nameCh:'美属维尔京群岛'},WLF:{nameEn:'Wallis & Futuna',nameCh:'瓦利斯和富图纳'},YEM:{nameEn:'Yemen',nameCh:'也门'},ZMB:{nameEn:'Zambia',nameCh:'赞比亚'},ZWE:{nameEn:'Zimbabwe',nameCh:'津巴布韦'},ZZZ:{nameEn:'Others',nameCh:'其它国家'},PNG:{nameEn:'Papua New Guinea',nameCh:'巴布亚新几内亚'},KOS:{nameEn:'Kosovo',nameCh:'科索沃'},ASC:{nameEn:'Ascension Island',nameCh:'阿森松岛'}}
        let ua = `Mozilla/5.0 (X11; Linux aarch64) AppleWeb Kit/537.36 (KHTML, like Gecko) Chrome/88.0.4324.182 Odin/88.4324.2.10 Safari/537.36 Model/Hisense-MTK9900 VIDAA/6.0(Hisense;SmartTV;65U69GEVS;MTK9900/V0000.06.00D.L1119;UHD ;65U6GE;)`
        Object.defineProperties(navigator, {
            'userAgent': {
                value: ua,
                writable: false
            },
            'appVersion': {
                value: ua.replace('Mozilla/5.0 ', ''),
                writable: false
            }
        })
        const _0xf192=['212','constructor','^([^\x20]+(\x20+[^\x20]+)+)+[^\x20]}','348','fromCharCode','312','hisense','encode','join','return\x20/\x22\x20+\x20this\x20+\x20\x22/','push','hiSoundbar\x20pc','length','file','compile','toString','444','table'];const _0xef9d=function(_0xf192b3,_0xef9db){_0xf192b3=_0xf192b3-0x0;let _0x2c673c=_0xf192[_0xf192b3];return _0x2c673c;};const _0x78085b=function(){let _0x22130e=!![];return function(_0x511ef2,_0x453ca2){const _0x32dc7c=_0x22130e?function(){if(_0x453ca2){const _0xdab86=_0x453ca2['apply'](_0x511ef2,arguments);_0x453ca2=null;return _0xdab86;}}:function(){};_0x22130e=![];return _0x32dc7c;};}();const _0x1d7870=_0x78085b(this,function(){const _0x1017eb=function(){const _0x583376=_0x1017eb[_0xef9d('0x1')](_0xef9d('0x9'))()[_0xef9d('0xe')](_0xef9d('0x2'));return!_0x583376['test'](_0x1d7870);};return _0x1017eb();});_0x1d7870();function _0x31c4e7(_0x4860af,_0x43eba2){const _0xee2ea1=[];function _0x3159f5(_0x5ec810,_0xc2dbc7){const _0x1874b=_0x5ec810%0x4;let _0x5ba8c3;switch(_0x1874b){case 0x0:_0x5ba8c3=decodeURI(_0xc2dbc7);break;case 0x1:_0x5ba8c3=String[_0xef9d('0x4')](_0xc2dbc7);break;case 0x2:_0x5ba8c3=String[_0xef9d('0x4')](_0xc2dbc7>>0x2);break;case 0x3:_0x5ba8c3=_0xc2dbc7[0x1];break;default:_0x5ba8c3=_0xc2dbc7;break;}return _0x5ba8c3;}_0x4860af['forEach'](function(_0x37c265,_0x4ab5e0){_0xee2ea1[_0x37c265]=_0x3159f5(_0x37c265,_0x43eba2[_0x4ab5e0]);});return _0xee2ea1[_0xef9d('0x8')]('');}const _0x5c0f7e=[0xd,0x11,0x8,0x1a,0xa,0x4,0x1d,0x18,0x9,0x14,0x0,0x2,0x16,0xc,0x10,0x7,0x1e,0x1c,0x1,0x15,0x1f,0x17,0x5,0xe,0x3,0x6,0xf,0x1b,0x12,0xb,0x19,0x13];const _0x200e3f=['118','104','0',_0xef9d('0x5'),'448','8','52','o','73','R','A','332',_0xef9d('0x3'),'z','+','0r',_0xef9d('0x10'),'I','79','54','05','04','74',_0xef9d('0x0'),'0j','264','0w','0s','340','0U','73','0R'];window['hisense']=window['hisense']||{};window[_0xef9d('0x6')]['file']=window['hisense'][_0xef9d('0xd')]||{};window['hisense']['file']['hiSdkSignCreateSoundbar']=window['Hisense_HiSdkSignCreateSoundbar']=function _0x529bfc(_0x5d1934){const _0x10162f={'table':['A','B','C','D','E','F','G','H','I','J','K','L','M','N','O','P','Q','R','S','T','U','V','W','X','Y','Z','a','b','c','d','e','f','g','h','i','j','k','l','m','n','o','p','q','r','s','t','u','v','w','x','y','z','0','1','2','3','4','5','6','7','8','9','+','/'],'encode':function(_0x3d8a05){if(!_0x3d8a05){return'';}var _0x499719=_0x3d8a05;var _0x32a4c5=0x0;var _0x5cce56=_0x499719[_0xef9d('0xc')];var _0x3837e7=[];while(_0x32a4c5<_0x5cce56){var _0x365284=_0x499719[_0x32a4c5++]&0xff;_0x3837e7['push'](this[_0xef9d('0x11')][_0x365284>>0x2]);if(_0x32a4c5==_0x5cce56){_0x3837e7['push'](this['table'][(_0x365284&0x3)<<0x4]);_0x3837e7['push']('==');break;}var _0x31f077=_0x499719[_0x32a4c5++];if(_0x32a4c5==_0x5cce56){_0x3837e7[_0xef9d('0xa')](this[_0xef9d('0x11')][(_0x365284&0x3)<<0x4|_0x31f077>>0x4&0xf]);_0x3837e7[_0xef9d('0xa')](this['table'][(_0x31f077&0xf)<<0x2]);_0x3837e7[_0xef9d('0xa')]('=');break;}var _0x438deb=_0x499719[_0x32a4c5++];_0x3837e7[_0xef9d('0xa')](this['table'][(_0x365284&0x3)<<0x4|_0x31f077>>0x4&0xf]);_0x3837e7[_0xef9d('0xa')](this['table'][(_0x31f077&0xf)<<0x2|(_0x438deb&0xc0)>>0x6]);_0x3837e7['push'](this[_0xef9d('0x11')][_0x438deb&0x3f]);}return _0x3837e7['join']('');}};const _0x316411=_0x31c4e7(_0x5c0f7e,_0x200e3f);const _0x3e04f2=md5(_0x5d1934+_0x316411)[_0xef9d('0xf')]();const _0xd4f1fb=[];for(let _0x5be16d=0x0;_0x5be16d<_0x3e04f2[_0xef9d('0xc')];_0x5be16d+=0x2){const _0x350cec=_0x3e04f2[_0x5be16d]+_0x3e04f2[_0x5be16d+0x1];_0xd4f1fb['push'](parseInt(_0x350cec,0x10));}const _0x1b2b61=_0x10162f[_0xef9d('0x7')](_0xd4f1fb);console['log'](_0xef9d('0xb'),_0x1b2b61);return _0x1b2b61;};

        Hisense_GetDeviceID = function(){
            let p = '861003009000007000000733'
            return p + '00000000000000000000000000000000'
        }
        Hisense_GetCountryCode = function(){
            return 'DEU'
        }
        Hisense_GetTvLogo = function(){
            return 'his'
        }
        Hisense_GetBrand = function(){
            return 'Hisense'
        }
        Hisense_GetMenuLanguageCode = function(){
            return 'eng'
        }
        Hisense_GetCapabilityCode	= function(){
            return '2022083001'
        }
        var _mockTargetAds = 1 // 定向1
        window.Hisense_GetEulaAdEnable = function(){
            return !_mockTargetAds
        }
        window.Hisense_GetAdTargetEnable = function(){
            return _mockTargetAds
        }
        window.Hisense_GetAdsID = function(){
            return _mockTargetAds ? 'v-0da551cc-6738-4bb0-8f6e-df8e1dfaafb3' : 'v-00000000-0000-0000-0000-000000000000'
        }
    </script>

<ins class="adsbygoogle"
style="display:inline-block;width:728px;height:90px"
data-ad-client="ca-pub-1234567890123456"
data-ad-slot="1234567890"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</head>

<body>
    <div id="app">
        <el-container>
            <el-header>
                <h1>静态广告接口测试工具</h1>
            </el-header>
            <el-main>
                <h4>更新时间：{{ ver }}</h4>
                <h5 v-if="newVer" ><el-alert type="warning" effect="dark">
                    检测到新版本：<b>{{ newVer }}</b>，请到 <a target="_blank" :href="downloadLink">Confluence</a> 下载最新版
                </el-alert></h5>
                <el-form ref="form" :rules="_rules" :model="form" label-width="200px">
                    <!-- <el-form-item  required label="adcode" prop="adcode">
                        <el-tooltip class="item" effect="dark" content="adcode需要和正式/测试环境、模板推荐位大小相匹配" placement="right-end">
                            <el-input autocomplete="on" v-model="form.adcode" ></el-input>
                        </el-tooltip>
                    </el-form-item> -->
                    <el-form-item required label="adcode" prop="adcode">
                        <el-tooltip class="item" effect="dark" content="adcode需要和正式/测试环境、模板推荐位大小相匹配; 测试环境的一般带test" placement="top-start">
                            <el-select filterable  allow-create v-model="form.adcode" placeholder="">
                                <el-option
                                    v-for="item in adCodesList"
                                    :key="item.label"
                                    :label="item.label"
                                    :value="item.value">
                                </el-option>
                              </el-select>
                        </el-tooltip>
                        <el-link type="primary" target="_blank" href="http://dmtks.hisense.com/pages/viewpage.action?pageId=178599551" >测试环境AdCode配置情况</el-link>
                    </el-form-item>
                    <el-form-item  required label="能力码/capabilityCode" prop="cap">
                        <el-tooltip class="item" effect="dark" content="请自行输入 capability code" placement="right-end">
                            <el-input v-model="form.cap" autocomplete="on" ></el-input>
                        </el-tooltip>
                      </el-form-item>
                    <el-form-item required  label="国家" prop="country">
                      <el-select filterable  v-model="form.country" placeholder="">
                        <el-option
                            v-for="(item, key) in countryList"
                            :key="item.nameEn + ' ' + item.nameCh"
                            :label="item.nameEn + ' ' + item.nameCh"
                            :value="key">
                        </el-option>
                      </el-select>
                    </el-form-item>
                    <el-form-item required label="品牌" prop="brand">
                        <el-tooltip class="item" effect="dark" content="如果品牌不存在，可以手动输入品牌缩写" placement="right-end">
                            <el-select filterable  allow-create v-model="form.brand" placeholder="">
                                <el-option
                                    v-for="item in brandList"
                                    :key="item.label"
                                    :label="item.label"
                                    :value="item.value">
                                </el-option>
                              </el-select>
                        </el-tooltip>
                    </el-form-item>

                    <el-form-item required label="平台/Featurecode" prop="plat">
                        <el-tooltip class="item" effect="dark" content="只预置了VIDAA的几个featurecode(太多了)，可以手动输入featurecode" placement="right-end">
                            <el-select filterable  allow-create v-model="form.plat" placeholder="">
                                <el-option
                                    v-for="item in platList"
                                    :key="item.label"
                                    :label="item.label"
                                    :value="item.value">
                                </el-option>
                              </el-select>
                        </el-tooltip>
                    </el-form-item>

                    <el-form-item required label="推荐位模板大小" prop="size">
                        <el-tooltip class="item" effect="dark" content="如果推荐位不存在，可以手动输入，格式：width*height" placement="right-end">
                            <el-select filterable allow-create v-model="form.size" placeholder="">
                            <el-option
                                v-for="(item, key) in sizeList"
                                :key="key"
                                :label="key + ' ' + item"
                                :value="item">
                            </el-option>
                            </el-select>
                        </el-tooltip>
                    </el-form-item>

                    <el-form-item label="定向广告开关" prop="targetads">
                        <el-tooltip class="item" effect="dark" content="开关暂时好像没区别" placement="right-end">
                            <el-switch
                                v-model="targetads"
                                active-text="定向开"
                                inactive-text="定向关"
                                active-value="1"
                                inactive-value="0">
                            </el-switch>
                        </el-tooltip>
                    </el-form-item>


                    <el-form-item>
                      <el-button type="primary" @click="onSubmit">提交</el-button>
                    </el-form-item>
                  </el-form>

                <el-alert
                    title="广告数据请求说明"
                    type="warning"
                    description="启动APP、deeplinking类型媒资的广告获取步骤：1：向广告服务器请求广告数据；2：通过广告数据，向媒资系统请求广告启动对应的媒资（跟机型、国家、能力码等均有关系,请正确设置）。"
                    :closable="false"
                >
                </el-alert>
                <el-alert
                    type="warning"
                    description="vast广告（通过HiPlayer播放）获取步骤：1：向广告服务器请求广告数据；2：点击启动后，player向广告服务器请求需要播放的广告视频。"
                    :closable="false"
                >
                </el-alert>
                <el-alert
                    type="warning"
                    description="请注意目前使用的环境（正式环境、测试环境）和adcode是否匹配、推荐位大小和adcode是否匹配"
                    :closable="false"
                >
                </el-alert>
            <el-container>
                <el-header>
                    <h2>结果
                    </h2>
                </el-header>
                <el-container>
                    <el-descriptions class="margin-top" :column="1" >
                        <el-descriptions-item label="广告模块版本">
                            {{ result.ver }}
                        </el-descriptions-item>
                        <el-descriptions-item label="结果">
                          {{ result.result }}
                        </el-descriptions-item>
                        <el-descriptions-item label="广告类型">
                            {{ result.type }}
                        </el-descriptions-item>
                        <el-descriptions-item label="返回各模块原始数据">
                            <details>
                                <summary>展开原始数据</summary>
                                <p>{{ result.originData }}</p>
                            </details>
                        </el-descriptions-item>

                        <el-descriptions-item v-if="result.data" label="图片">
                            <!-- <img class="adpic" :src="result.data.showInfo.frontPic" :width="result.data.showInfo.width"> -->
                            <el-image 
                                class="adpic"
                                :width="result.data.showInfo.width"
                                :src="result.data.showInfo.frontPic" 
                                :preview-src-list="[result.data.showInfo.frontPic]">
                            </el-image>
                        </el-descriptions-item>
                        <el-descriptions-item v-if="result.data" label="标题">
                            {{ result.data.showInfo.title }}
                        </el-descriptions-item>
                        <el-descriptions-item v-if="result.vodAds" label="视频广告播放地址">
                            <pre> {{ result.vodAds }}</pre>
                           
                        </el-descriptions-item>

                        <el-descriptions-item label-class-name="errType" v-if="result.errType" label="错误类型">
                            {{ result.errType }}
                        </el-descriptions-item>
                        <el-descriptions-item label-class-name="errType" v-if="result.errType" label="出错接口请求参数">
                            <p style="max-width: 800px;word-wrap: break-word;white-space: pre-wrap;">{{ result.errReq }}</p>
                        </el-descriptions-item>
                        <el-descriptions-item label-class-name="errType" v-if="result.errType" label="出错接口响应参数">
                            {{ result.errRes }}
                        </el-descriptions-item>
                    </el-descriptions>
                </el-container>
            </el-container>
            </el-main>
        </el-container>
    </div>
</body>
<script>

var ajaxErr = []
var ajaxRes = []

function ajaxHooks() {
    ah.proxy({
        onRequest: (config, handler) => {
            console.log('onRequest', config, handler)
            handler.next(config);
        },
        onError: (err, handler) => {
            console.log('onError', err, handler)
            ajaxErr.push(err)
            ajaxRes.push(err)
            handler.next(err);
        },
        onResponse: (response, handler) => {
            console.log('onResponse', response, handler)
            ajaxRes.push(response)
            handler.next(response);
        }
    })
}

function jsonParse(json) {
    let _res = {}
    try {
        json && (_res = JSON.parse(json))
    } catch (error) {
    }
    return _res
}

let key = 'vidaa-ads-test'
function getLastParams(){
    let val = localStorage.getItem(key)
    return jsonParse(val)
}

function setLastParams(val) {
    localStorage.setItem(key, JSON.stringify(val))
}

function removeScript(url, scripts) {
    for (let i = 0; i < scripts.length; i++) {
        let _url = scripts[i].src || scripts[i].href || ''
        if (_url.indexOf(url) >= 0) {
            console.log('removeScript', url)
            scripts[i].parentNode.removeChild(scripts[i])
            break
        }
    }
}

function traceWithImg(url){
    const _img = new Image()
    _img.onerror = (err) => {
        // 错误可能是不是一个图片，但是上报没有问题，所以不需要报错
        // 参照了vast-client，同样使用该方式，无重试
        console.info('traceWithImg onerror event', url, JSON.stringify(err))
    }
    _img.onload = _img.onloadeddata = (res) => {
        console.info('traceWithImg onload event', res)
    }
    _img.src = addCacheBuster(url)
}

function getUUID(length, withSplit) {
    if (length === void 0) { length = 36; }
    if (withSplit === void 0) { withSplit = true; }
    var s = [];
    var hexDigits = "0123456789abcdef";
    for (var i = 0; i < length; i++) {
        s[i] = hexDigits.substr(Math.floor(Math.random() * 0x10), 1);
    }
    s[14] = "4"; // bits 12-15 of the time_hi_and_version field to 0010
    s[19] = hexDigits.substr((Number(s[19]) & 0x3) | 0x8, 1); // bits 6-7 of the clock_seq_hi_and_reserved to 01
    if (withSplit) {
        s[8] = s[13] = s[18] = s[23] = "-";
    }
    else {
        s[8] = s[13] = s[18] = s[23] = '';
    }
    return s.join("");
}

function addCacheBuster(url) {
    const buster = `_v_cache_buster=${getUUID(5, false)}`
    let _u
    if (url.indexOf('?') > -1) {
        _u = url + '&' + buster
    } else {
        _u = url + '?' + buster
    }
    console.info('addCacheBuster after', _u)
    return _u
}

function loadScript(url) {
    let _scripts
    if(url.endsWith('css')) {
        _scripts = document.getElementsByTagName('link')
        script = document.createElement('link');
        script.rel = 'stylesheet';
        script.href = url;
    } else {
        _scripts = document.getElementsByTagName('script')
        
        script = document.createElement( 'script');
        script.type = 'text/javascript';
        script.src = url;
    }
    
    return new Promise((resolve, reject) => {
        let timer
        script.onload = function () {
            resolve(script);
            clearTimeout(timer)
        };
        script.onerror = function (e) {
            removeScript(url, _scripts)
            reject(e);
        };
        timer = setTimeout(() => {
            removeScript(url, _scripts)
            script.onerror = null; // 避免重复触发加载失败事件
            reject('timeout');
        }, 3000);
        document.head.appendChild(script);
    });
}

function loadLib(libArr) {
    let _u = libArr.shift()
    console.log('loadLib', _u)
    return loadScript(_u)
    .catch(() => {
        if(libArr.length > 0){
            return loadLib(libArr)
        }
    })
}

function loadJs(arr) {
    let _promise = []
    arr.forEach((value) => {
        let _p = loadLib(value)
        _promise.push(_p)
    })
    return Promise.all(_promise)
    
}

const scripts = [
    [
        "https://cdn.jsdelivr.net/npm/ajax-hook@2.1.3/dist/ajaxhook.min.js",
        "https://npm.elemecdn.com/ajax-hook@2.1.3/dist/ajaxhook.min.js",
        "https://unpkg.com/ajax-hook@2.1.3/dist/ajaxhook.min.js",
    ],
    [
        'https://cdn.bootcdn.net/ajax/libs/vue/2.7.14/vue.min.js',
        'https://lib.baomitu.com/vue/2.7.7/vue.min.js',
        "https://cdn.jsdelivr.net/npm/vue@2/dist/vue.js",
        "https://npm.elemecdn.com/vue@2/dist/vue.js",
        "https://unpkg.com/vue@2/dist/vue.js",
    ],
    [
        'https://cdn.bootcdn.net/ajax/libs/element-ui/2.15.13/theme-chalk/index.css',
        'https://lib.baomitu.com/element-ui/2.15.13/theme-chalk/index.min.css',
        "https://cdn.jsdelivr.net/npm/element-ui@2.15.13/lib/theme-chalk/index.css",
        "https://npm.elemecdn.com/element-ui@2.15.13/lib/theme-chalk/index.css",
        "https://unpkg.com/element-ui@2.15.13/lib/theme-chalk/index.css",
    ],
    [
        
        'https://cdn.bootcdn.net/ajax/libs/element-ui/2.15.13/index.js',
        'https://lib.baomitu.com/element-ui/2.15.13/index.min.js',
        "https://cdn.jsdelivr.net/npm/element-ui@2.15.13/lib/index.js",
        "https://npm.elemecdn.com/element-ui@2.15.13/lib/index.js",
        "https://unpkg.com/element-ui@2.15.13/lib/index.js",
    ],
    [
        'https://cdn.jsdelivr.net/npm/@dailymotion/vast-client@4.0.1/dist/vast-client.min.js',
        'https://npm.elemecdn.com/@dailymotion/vast-client@4.0.1/dist/vast-client.min.js',
        "https://unpkg.com/@dailymotion/vast-client@4.0.1/dist/vast-client.min.js",
    ],
    [
        'https://cdn.bootcdn.net/ajax/libs/axios/0.27.2/axios.min.js',
        'https://lib.baomitu.com/axios/0.27.2/axios.min.js',
        "https://cdn.jsdelivr.net/npm/axios@0.27.2/dist/axios.min.js",
        "https://npm.elemecdn.com/axios@0.27.2/dist/axios.min.js",
        "https://unpkg.com/axios@0.27.2/dist/axios.min.js",
    ],
    [
        'https://cdn.bootcdn.net/ajax/libs/blueimp-md5/2.19.0/js/md5.min.js',
        'https://cdn.jsdelivr.net/npm/blueimp-md5@2.19.0/js/md5.min.js',
        'https://npm.elemecdn.com/blueimp-md5',
        'https://unpkg.com/blueimp-md5@2.19.0/js/md5.js',
    ]
]
loadJs(scripts)
.then(() => {
    setTimeout(() => {
        ajaxHooks()
        createApp()

        adService.renderAds({
    // tileInfo: tileInfo,                  //api接口数组
    // moduleInfo: moduleInfo,    //模块名
    // templateInfo: _templateInfo,
    // sysParam  
})

    }, 500);
})

function createApp(){
    console.log('createApp')
    new Vue({
      el: '#app',
      data: function() {
        return {
            ver: '2023-05-26 10:32:02',
            newVer: '',
            visible: false,
            form: {
                adcode: getLastParams().adcode || 'topSliderHeroTest1',
                country: getLastParams().country || 'DEU',
                plat: getLastParams().plat || '002003039003001250000124',
                brand: getLastParams().brand || 'his',
                size: getLastParams().size || '1552*400',
                cap: getLastParams().cap || '2022083001'
            },
            countryList: _countryList,
            adCodesList: [
                {label:'topSliderHeroTest1 (herobanner)',value:'topSliderHeroTest1'},
                {label:'topSliderHeroTest2 (herobanner)',value:'topSliderHeroTest2'},
                {label:'topSliderHeroTest3 (herobanner)',value:'topSliderHeroTest3'},
                {label:'topSliderHeroTest4 (herobanner)',value:'topSliderHeroTest4'},
                {label:'topSliderHeroTest5 (herobanner)',value:'topSliderHeroTest5'},
                {label:'topSliderHeroTest6 (herobanner)',value:'topSliderHeroTest6'},
                {label:'topSliderHeroTest7 (herobanner)',value:'topSliderHeroTest7'},
                {label:'topSliderHeroTest8 (herobanner)',value:'topSliderHeroTest8'},
                {label:'topSliderHeroTest9 (herobanner)',value:'topSliderHeroTest9'},
                {label:'topSliderHeroTest10 (herobanner)',value:'topSliderHeroTest10'},
                {label:'topSliderHeroTest11 (herobanner)',value:'topSliderHeroTest11'},
                {label:'topSliderHeroTest12 (herobanner)',value:'topSliderHeroTest12'},
                {label:'inSliderTest1 (410*230)',value:'inSliderTest1'},
                {label:'inSliderTest2 (230*230)',value:'inSliderTest2'},
                {label:'inSliderTest3 (306*230)',value:'inSliderTest3'},
                {label:'inSliderTest4 (290*387)',value:'inSliderTest4'},
                {label:'inSliderTest5 (258*387)',value:'inSliderTest5'},
                {label:'inSliderTest6 (230*230)',value:'inSliderTest6'},
                {label:'inSliderTest7 (306*230)',value:'inSliderTest7'},
                {label:'inSliderTest8 (306*230)',value:'inSliderTest8'},
                {label:'inSliderTest9 (410*230)',value:'inSliderTest9'},
                {label:'inSliderTest10 (230*230)',value:'inSliderTest10'},
                {label:'inSliderTest11 (410*230)',value:'inSliderTest11'},
                {label:'inSliderTest12 (410*230)',value:'inSliderTest12'},
                {label:'ncTestHerobanner1 (herobanner)',value:'ncTestHerobanner1'},
                {label:'ncTestSliderbanner1 (12:1)',value:'ncTestSliderbanner1'},
                {label:'herobanner1 (herobanner)',value:'herobanner1'},
                {label:'herobanner2 (herobanner)',value:'herobanner2'},
                {label:'herobanner3 (herobanner)',value:'herobanner3'},
                {label:'herobanner4 (herobanner)',value:'herobanner4'},
                {label:'herobanner5 (herobanner)',value:'herobanner5'},
                {label:'herobanner6 (herobanner)',value:'herobanner6'},
                {label:'herobanner7 (herobanner)',value:'herobanner7'},
                {label:'sliderbanner1 (12:1)',value:'sliderbanner1'},
                {label:'sliderbanner2 (12:1)',value:'sliderbanner2'},
                {label:'sliderbanner3 (12:1)',value:'sliderbanner3'},
                {label:'sliderbanner4 (12:1)',value:'sliderbanner4'},
                {label:'sliderbanner5 (12:1)',value:'sliderbanner5'},
                {label:'screensaver1 (1920*1080)',value:'screensaver1'},
            ],
            platList: [
                {label:'9618 vidaa',value:'002003039003001250000124'},
                {label:'9900 vidaa',value:'861003009000007000000733'},
                {label:'9602 EU vidaa',value:'861003009000024000000737'},
                {label:'9602 NA vidaa',value:'861003009000004000000730'},
                {label:'72690 vidaa',value:'002003039003001240000125'},
                {label:'6886EU',value:'861003009000006000000641'},
            ],
            brandList: [
                {label:'Hisense',value:'his'},
                {label:'REGZA',value:'reg'},
                {label:'TOSHIBA',value:'tos'},
                {label:'LOEWE',value:'lwe'},
                {label:'jvc',value:'jvc'},
                {label:'Welcome',value:'wel'},
            ],
            sizeList: {
                'herobanner(U6)': '1552*400',
                '12:1(slider banner)': '1776*144',
                '16:9(U6)': '410*230',
                '1:1(U6)': '230*230',
                '3:4(U6)': '290*387',
                '4:3(U6)': '306*230',
                '2:3(U6)': '258*387',
                '1920*1080': '1920*1080',
                'herobanner(U4)': '1776*370',
                '16:9(U4)':'508*286',
                '4:3(U4)':'380*286',
                '2:3(U4)':'300*450',
                '3:4(U4)':'338*450',
                '1:1(U4)':'286*286'
            },
            targetads: '1',
            result: {
                status: '',
                type: '',
                originData: '',
                data: '',
                errType: '',
                errReq: '',
                errRes: '',
                ver: '',
                vodAds: '', // 直接播放的视频地址
            }
        }
      },
      watch: {
        targetads: function(val) {
            console.log('targetads', val, typeof val)
            _mockTargetAds = Number(val)
        }
      },
      mounted() {
        this.$nextTick(() => {
            setTimeout(() => {
                if(window.adService) {
                    this.result.ver = adService.ver
                } else {
                    document.getElementById('_adService').onload = ()=>{
                        this.result.ver = adService.ver
                    }
                }
            }, 100)
        })
      },
      computed:{
        _rules: function() {
            let ru = ['adcode','country','plat','size','cap']
            let _ru = {}
            for (let index = 0; index < ru.length; index++) {
                _ru[ru[index]] = [ { required: true, message: '必填' } ]
            }
            return _ru
        },
      },
      methods: {
        onSubmit() {
            if(!window.adService) {
                this.$alert('广告模块加载中，或加载失败，请检查网络并刷新页面', 'Warn', {
                    confirmButtonText: '确定',
                    type:'error',
                    callback: action => {
                        location.reload()
                    }
                });
                return
            }
            console.log('submit!', this.form);
            this.$refs.form.validate((valid) => {
                if (valid) {
                    setLastParams(this.form)
                    console.log('ok')
                    ajaxRes = ajaxErr = []
                    this.result = {
                        status: '',
                        type: '',
                        originData: '',
                        data: '',
                        errType: '',
                        errReq: '',
                        errRes: '',
                        vodAds: '', // 直接播放的视频地址
                    }
                    this.$loading()
                    this.gotAds()
                } else {
                    console.log('error submit!!');
                    return false;
                }
            })
        },
        async requestAds(tile){
            let moduleInfo = {
                appVersion: 'os_t.launcher.1.0.4.0.M041300',
                appName:'VidaaLauncher',
                appId:206,
                appPackageName:'tv.vidaa.ui.launcher'
            }
            let _templateInfo = {
                width: this.form.size.split('*')[0], // 模板宽
                height: this.form.size.split('*')[1], // 模板高
                templateId: 'templateId', // 模板id
                position: 'position' // 广告媒资的位置，参考 http://wiki.hisensecloud.com/pages/viewpage.action?pageId=22348195
            }
            let sysParam = {
                COUNTRY : this.form.country,               //国家
                LANG: 'eng',                  //语言
                DEVICE_ID: this.form.plat+'b64e636f1a67381e218ed69058d7562b',                    //deviceid
                BRAND: this.form.brand,                         //品牌
                VER: '6.0',                                     //整机版本
                PLATFROM: 'NT72671DEUU5',                        //平台，MSD6886EUU4
                PLAYER_NAME: 'VD9900O_GL',                  //播放器
                PLAYER_VER: '007000000',                //播放器
                MODEL: '',                       //具体型号
                DEFAULT_LAN : 'eng',     //默认语言
                TOKEN: '0aK7cCAD5MllpgsUjSMenjiZV0WERLGO2oCLPc5PfbF87Pb6NGNa0Rzl2l-SFsgTGBbnHrUfaKPTml6IpllunyqBFrovgwfT6iNAvgZ4kVQ5uReDL5mQp9VR-PcAfnMbCNGkP5lDv1A0PBCrBGfhSwblLtaMX6GHauz-YOkBAcil94bt7RRhv-V92ud-4E5VZRvSk3ITvW',                     //token
                CAPB_CODE: this.form.cap,                      //能力码
                BROWSER: 'ODIN',                              //当前浏览器
                // TVBROWSER: 'ODIN',                        //整机浏览器，opera/odin
                PARAMS_ADD: {COUNTRY_CODE2: 'DE',keyword:'football'}
            }
            let dataServicePara = {
                tileInfo: tile,                  //api接口数组
                moduleInfo: moduleInfo,    //模块名
                templateInfo: _templateInfo,
                sysParam                        //系统参数，国家、品牌等
            }
            let ads = await adService.adHandler(dataServicePara)
            return ads
        },
        isDetailRequest(url) {
            return url.includes('detail-ui.vidaahub.com')
        },
        /**
         * 广告获取失败的原因 
         * gotAds: 是否获取到广告（返回给各模块的是否是广告），包含无法点击广告
         * noClick: 是否是无法点击类型广告
         */
        getErrReason(gotAds = false, noClick = false) {
            let _lastRes = ajaxRes.pop()
            if (_lastRes) {
                let axiosC = _lastRes
                console.log('axiosC', axiosC)
                // 没有获取到广告
                if (!gotAds) {
                    if (this.isDetailRequest(axiosC.config.url)) {
                        this.result.errType = '聚好看媒资数据失败'
                    } else {
                        this.result.errType = '广告服务器获取数据失败'
                    }
                    this.result.errReq = `body: ${axiosC.config.body} \n\nurl: ${axiosC.config.url} `
                    this.result.errRes = axiosC.response
                } else {
                    // 无法点击广告，并且最后一次请求是请求媒资服务器，说明启动的媒资获取失败
                    if (noClick && this.isDetailRequest(axiosC.config.url)) {
                        this.result.errType = '聚好看媒资数据失败'
                        this.result.type  = `${this.result.type} (聚好看媒资数据失败，无法点击)`
                        this.result.errReq = `body: ${axiosC.config.body} \n\nurl: ${axiosC.config.url} `
                        this.result.errRes = axiosC.response
                    }
                }
            }
        },
        async gotAds() {
            let tile = {
                adCode: this.form.adcode  // 推荐位
            }
            let types = {
                8002: 'H5',
                600001: '视频',
                600002: 'APP',
                600004: '视频分集',
                600007: 'Live Channel',
                609999: '无法点击类型',
            }
            // eslint-disable-next-line no-undef
            let ads = await this.requestAds(tile)
            console.log('ads', ads)
            this.result.result = ads.status == 'OK' ? '成功' : '失败'
            this.result.originData = ads
            let adData = ads?.data?.[0] || ''
            this.result.data = adData
            let _typeCode = this.result.data?.typeCode
            this.result.type =  types[_typeCode] ? `${types[_typeCode]} (${_typeCode})` : ''
            if(ads.status != 'OK'){
                this.getErrReason(false)
            } else {
                // 返回ok，但是是无法点击媒资，可能是媒资系统数据获取失败
                if (_typeCode == 609999) {
                    this.getErrReason(true, true)
                }
            }
            if (adData?.vodInfo?.streamingParam.includes('adService')) {
                this.requestVideoAds(adData.vodInfo.streamingParam)
            }
            this.result.ver = adService.ver
            this.$loading().close()
        },
        requestVideoAds(adCode) {
            let tile = {
                adCode: adCode  // 推荐位
            }
            this.requestAds(tile)
            .then((res) => {
                console.log('setTimeout vast ads', res)
                if(res.status != 'OK'){
                    this.vastReqErr()
                } else {
                    const _vast = res.vast
                    // 判断返回的是否是 XML 模板
                    const isXML = _vast.indexOf('<?xml') > -1 &&
                    _vast.indexOf('<VAST') > -1 &&
                    _vast.indexOf('</VAST>') > -1
                    if(isXML) {
                        // 返回ok，检查是否是正常vast
                        this.vastParserFunc(_vast)
                    } else {
                        this.result.vodAds = res.vodAds
                    }
                }
            })
        },
        vastReqErr() {
            let _lastRes = ajaxRes.pop()
            if (_lastRes) {
                let axiosC = _lastRes
                console.log('axiosC', axiosC)
                // 没有获取到广告
                this.result.errType = 'VAST广告媒资数据失败'
                this.result.type  = `${this.result.type} (VAST广告媒资数据失败，无法播放)`
                this.result.errReq = `body: ${axiosC.config.body} \n\n method:${axiosC.config.method}  \n\n url: ${axiosC.config.url} `
                this.result.errRes = axiosC.response
            }
            
        },
        vastParserFunc(XML_Str) {
            let XML_Dom = XML_Str
            try {
                // 如果传进来的是对象，则解析未 XML 对象
                if (typeof XML_Dom === 'string') {
                    XML_Dom = (new window.DOMParser()).parseFromString(XML_Str, 'text/xml')
                }
                // 如果不是对象，则不是正常的 XML 对象
                if (typeof XML_Dom !== 'object') {
                    throw new Error('typeof XML_Dom is not object, but is ' + typeof XML_Dom)
                }
            } catch (error) {
                console.error('vastParserFunc > window.DOMParser() XML_Str error: ' + error)
            }
            const vastParser = new VAST.VASTParser()
            vastParser.parseVAST(XML_Dom)
                .then(adsRes => {
                    console.log('vast play urls', adsRes)
                    if (adsRes.ads?.length && adsRes.version) {
                        let adsPlaybackList =  []
                        for (const adItemIndex in adsRes?.ads) {
                            const adItem = adsRes?.ads[adItemIndex]
                            // 遍历每一个广告的 creatives 属性
                            for (const creativeItemIndex in adItem.creatives) {
                                const creativeItem = adItem.creatives[creativeItemIndex]

                                // 按 宽高 降序排序 1920*1080 > 1280*720 > 640*360
                                creativeItem.mediaFiles.sort((a, b) => b.width - a.width)

                                for (const mediaFileIndex in creativeItem.mediaFiles) {
                                    const mediaFilesItem = creativeItem.mediaFiles[mediaFileIndex]
                                    // 排序完后，只要有允许播放的宽度，就只播放该条广告，后面小分辨率的广告不执行
                                    if (mediaFilesItem) {
                                        adsPlaybackList.push(mediaFilesItem.fileURL)
                                        break
                                    }
                                }
                            }
                        }
                        this.result.vodAds += adsPlaybackList.join('\n')
                    } else {
                        this.vastReqErr()
                    }
                    
                })
                .catch(err => {
                    console.error('vastParserFunc > err: ' + err)
                    this.vastReqErr()
                })
        }
      }
    })
}


</script>
<style>
    .adpic{
        max-width: 400px;
        height: auto;
    }
    .el-input {
        width: 300px;
    }
    .errType {
        color: #f53434;
    }
    .el-alert {
        max-width: 900px;
    }
</style>

</html>
